#pragma checksum "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "5d284a2a08384e7e756425f8dd7f6573444dc611"
// <auto-generated/>
#pragma warning disable 1591
namespace WordDisplay.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using WordDisplay;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/_Imports.razor"
using WordDisplay.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
using WordDisplay.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
using WordDisplay.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
using System.Text;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
using Microsoft.AspNetCore.SignalR.Client;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class Index : Microsoft.AspNetCore.Components.ComponentBase, IAsyncDisposable
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenElement(0, "div");
            __builder.AddAttribute(1, "class", "main");
            __builder.OpenElement(2, "div");
            __builder.AddAttribute(3, "class", "header");
            __builder.AddMarkupContent(4, "<h1 class=\"h1-main\">Word Display!</h1>\n        ");
            __builder.OpenElement(5, "button");
            __builder.AddAttribute(6, "class", "btn-start");
            __builder.AddAttribute(7, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 14 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                                            Start

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(8, "Start");
            __builder.CloseElement();
#nullable restore
#line 16 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
         if (!string.IsNullOrWhiteSpace(error))
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(9, "h4");
            __builder.AddAttribute(10, "class", "h4-error");
            __builder.AddContent(11, 
#nullable restore
#line 18 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                                  error

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 19 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(12, "\n\n    ");
            __builder.OpenElement(13, "div");
            __builder.AddAttribute(14, "class", "content");
            __builder.OpenElement(15, "table");
            __builder.AddAttribute(16, "class", "table table-striped");
            __builder.AddMarkupContent(17, "<thead class=\"thead-dark\"><tr><th>Word</th>\n                    <th>Action</th></tr></thead>\n            ");
            __builder.OpenElement(18, "tbody");
#nullable restore
#line 31 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                 foreach (var word in words)
                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(19, "tr");
            __builder.OpenElement(20, "td");
            __builder.AddContent(21, 
#nullable restore
#line 34 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                             word

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(22, "\n                        ");
            __builder.OpenElement(23, "td");
            __builder.OpenElement(24, "button");
            __builder.AddAttribute(25, "class", "btn-remove");
            __builder.AddAttribute(26, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 35 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                                                                 ()=>Remove(word)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(27, "Remove");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 37 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                }

#line default
#line hidden
#nullable disable
            __builder.OpenElement(28, "tr");
            __builder.OpenElement(29, "td");
            __builder.OpenElement(30, "input");
            __builder.AddAttribute(31, "placeholder", "Enter word");
            __builder.AddAttribute(32, "size", "50");
            __builder.AddAttribute(33, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 39 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                                      WordInput

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(34, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => WordInput = __value, WordInput));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(35, "\n                    ");
            __builder.OpenElement(36, "td");
            __builder.OpenElement(37, "button");
            __builder.AddAttribute(38, "class", "btn-add");
            __builder.AddAttribute(39, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 40 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                                                          Add

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(40, "Add");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(41, "\n\n        ");
            __builder.OpenElement(42, "table");
            __builder.AddAttribute(43, "class", "table table-striped");
            __builder.AddMarkupContent(44, "<thead class=\"thead-dark\"><tr><th>CommandRunning</th>\n                    <th>CurrentWordSelected</th>\n                    <th>CommandTimeRemaining (s)</th></tr></thead>\n            ");
            __builder.OpenElement(45, "tbody");
            __builder.OpenElement(46, "tr");
            __builder.OpenElement(47, "td");
            __builder.AddContent(48, 
#nullable restore
#line 56 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                         state.CommandRunning

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(49, "\n                    ");
            __builder.OpenElement(50, "td");
            __builder.AddContent(51, 
#nullable restore
#line 57 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                         state.CurrentWordSelected

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(52, "\n                    ");
            __builder.OpenElement(53, "td");
            __builder.AddContent(54, 
#nullable restore
#line 58 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
                         state.CommandTimeRemaining

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 68 "/Users/machuynh/Desktop/WordDisplay/WordDisplay/Pages/Index.razor"
 
    private HubConnection hubConnection;
    private string WordInput { get; set; }
    private List<string> words = new List<string>();
    private ServerState state { get; set; } = new ServerState();
    public string error { get; set; }

    /// <summary>
    /// Create our HubConnection to connect to our ServerStateHub via SignalR, and register a handler to listen for changes.
    /// </summary>
    /// <returns></returns>
    protected override async Task OnInitializedAsync()
    {
        hubConnection = new HubConnectionBuilder()
            .WithUrl(new Uri("http://localhost:5555/state"))
            .Build();
        hubConnection.On<bool, string, int>("StateChanged", (commandRunning, currentWordSelected, commandTimeRemainining) =>
        {
            state.CommandRunning = commandRunning;
            state.CurrentWordSelected = currentWordSelected;
            state.CommandTimeRemaining = commandTimeRemainining;
            Console.WriteLine("[StateChanged]: " + commandRunning + " " + currentWordSelected + " " + commandTimeRemainining);
            StateHasChanged();
        });
        await hubConnection.StartAsync();
    }

    /// <summary>
    /// Dispose the HubConnection.
    /// </summary>
    /// <returns></returns>
    public async ValueTask DisposeAsync()
    {
        await hubConnection.DisposeAsync();
    }

    /// <summary>
    /// Adds the value stored in WordInput into our list.
    /// </summary>
    private void Add()
    {
        if (string.IsNullOrWhiteSpace(WordInput))
            return;
        words.Add(WordInput);
        WordInput = null;
    }

    /// <summary>
    /// Removes the word from our list.
    /// </summary>
    /// <param name="word">The word to delete.</param>
    private void Remove(string word)
    {
        words.Remove(word);
    }

    /// <summary>
    /// Make a REST call to our API Server to invoke the StartCommand with our words.
    /// </summary>
    /// <returns></returns>
    public async Task Start()
    {
        if (words.Count <= 0)
        {
            error = "Please enter at least one word before starting!";
            return;
        }
        error = null;

        Payload p = new Payload { Words = this.words };

        var serialized = JsonConvert.SerializeObject(p, Formatting.Indented);
        var content = new StringContent(serialized, Encoding.UTF8, "application/json");
        var request = new HttpRequestMessage { RequestUri = new Uri("http://localhost:5555/api/word"), Method = HttpMethod.Post, Content = content };
        Console.WriteLine("Sending: " + serialized);


        var client = clientFactory.CreateClient();
        HttpResponseMessage res = await client.SendAsync(request);

        error = res.IsSuccessStatusCode ? null : "Something went wrong with start...";
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IHttpClientFactory clientFactory { get; set; }
    }
}
#pragma warning restore 1591
